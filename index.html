<!DOCTYPE html>
<html lang = de>
<head>
	<Title>AVPRG</title>
    <meta charset=utf-8>
    <link rel=stylesheet href=stylesheet.css type=text/css>
</head>
<body>
    <div class=mainContainer>
        <h1>Beat LÃ¤ufer</h1>
        <div class=buttonContainer>
            <button class="menuButton playButton" onclick="openSongSelect();">
                Spielen
            </button>
            <button class="menuButton optionButton" onclick="openOptions();">
                Optionen
            </button>
            <button class="menuButton highscoreButton" onclick="openHighscores();">
                Highscore
            </button>
        </div>
    </div>
    <div id=overlaySongSelect>
        <button class=closeButton onclick="closeOverlay();"></button>
        <button class=ssButtons id=lvl1Button onclick="location.href='game.html?WeWillRockYou'";>
            <span>Queen - We Will Rock You</span>
        </button><br>
        <button class=ssButtons id=lvl2Button onclick="location.href='game.html?Level2'">
            <span>Band - Song 2</span>
        </button><br>
        <button class=ssButtons id=lvl3Button>
            <span>Band - Song 3</span>
        </button>
    </div>
    <div id=overlayOptions>
            <div id=text>Optionen</div>
        <button class=closeButton onclick="closeOverlay();"></button>
    </div>
    <div id=overlayHighscores>
            <div id=text>Highscore Liste</div>
        <button class=closeButton onclick="closeOverlay();"></button>
    </div>
    <script>
        document.getElementById("overlaySongSelect").style.display = "none";
        document.getElementById("overlayOptions").style.display = "none";
        document.getElementById("overlayHighscores").style.display = "none";
        function openSongSelect()
        {
            document.getElementById("overlaySongSelect").style.display = "block";
        }
        function openOptions()
        {
            document.getElementById("overlayOptions").style.display = "block";
        }
        function openHighscores()
        {
            document.getElementById("overlayHighscores").style.display = "block";
        }
        function closeOverlay()
        {
            document.getElementById("overlayOptions").style.display = "none";
            document.getElementById("overlayHighscores").style.display = "none";
            document.getElementById("overlaySongSelect").style.display = "none";
        }
    </script>
    <canvas id=canvasMenu width=800 height=200></canvas>
    <script>
        const FPS = 30;
        const backgroundSound = "sounds/Menu/Trancyvania.mp3";
        const backgroundDelay = 0.1;

        var canv = document.getElementById("canvasMenu");
        var ctx = canv.getContext("2d");
        var context = new AudioContext();
	    var request = new XMLHttpRequest();
        var sourceBuffer = context.createBufferSource();

        var platforms = [450];

        request.open('GET', backgroundSound, true);
	    request.responseType = 'arraybuffer';
        request.onload = function () 
        {
	    	var undecodedAudio = request.response;
            context.decodeAudioData(undecodedAudio, function (buffer) 
            {
	    		sourceBuffer.buffer = buffer;
                sourceBuffer.connect(context.destination);
                sourceBuffer.loop = true;
                sourceBuffer.start(context.currentTime +backgroundDelay);
	    	});
	    };
        request.send();

        setInterval(update, 1000 / FPS);

        function update()
        {
            ctx.fillStyle = "#333333";
            ctx.fillRect(0, 0, canv.width, canv.height);

            ctx.fillStyle = "white";
            ctx.fillRect(0, 100, canv.width, 30);

            for(var i = 0; i < platforms.length; i++)
            {
                platforms[i] = platforms[i] - 19;
                if(platforms[i] <= -80 )platforms[i] = 960
            }
            for(var i = 0; i < platforms.length; i++)
            {
                ctx.fillStyle = "blue"; 
                ctx.fillRect(platforms[i], 100, 50, 30);
            }

            ctx.strokeStyle = "red";
            ctx.lineWidth = 7;
            ctx.beginPath();
            ctx.moveTo(200, 0);
            ctx.lineTo(200, 150);
            ctx.stroke();
        }
    </script>
</body>
</html>